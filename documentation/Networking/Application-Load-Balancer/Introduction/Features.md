# 功能概览

## 应用负载均衡实例

- 应用负载均衡基本信息：所属VPC、子网、多可用区（AZ）等。应用负载均衡可以选择单AZ或者多AZ，但为了保障业务高可用、强烈建议选择多AZ。

- 弹性公网IP绑定/解绑：可自主选择是否绑定、解绑公网IP、自由切换，灵活搭建内网、公网类型的应用负载均衡，适应不同场景下的业务需求；通过公网IP绑定的方式，可隐藏内部网络结构，提高系统安全性。

- 应用负载均衡安全配置：关联、修改安全组规则。来自客户端的请求匹配应用负载均衡安全组的入规则，应用负载均衡分发到后端服务器的请求匹配应用负载均衡安全组的出规则。

## 监听器

- 监听规则：监听的协议类型与端口号信息，目前支持HTTPS/HTTP/TCP/TLS/UDP四种协议类型。用户在同一个应用负载均衡内可以定义多个监听器，不同监听器可以选择不同协议类型、或者选择相同协议类型但定义不同端口号。

- SSL证书：如果监听协议为HTTPS/TLS协议，需要在创建监听器时配置一个SSL证书。
   - 监听器创建完成后可为一个监听器配置多个SSL证书，实现不同访问域名的请求返回不同的SSL证书。
   - 同一个域名支持配置RSA和ECC双证书，负载均衡根据客户端支持证书类型返回不同加密算法的证书，兼顾兼容性、安全性、高效性，更好的满足多样的客户业务场景

- 空闲连接超时设置：针对一个监听规则的空闲连接超时设置。当连接空闲超时时，应用负载均衡会自动断开客户端与应用负载均衡之间、以及应用负载均衡与后端服务器之间的两端连接。
- HTTPS监听支持开启HSTS功能，强制客户端使用HTTPS与负载均衡进行通信，降低客户端第一次访问后端服务被劫持的风险，提高业务的安全性

## 转发规则组

- 转发规则：转发规则可基于访问请求的域名和URL路径将流量分发给不同的后端服务或重定向到指定的URL处理。一条转发规则中可定义匹配请求的域名、URL路径及执行的动作。

- 域名：用于匹配七层访问流量的域名和IP地址。域名支持精确匹配和通配符匹配两种。

- URL路径：用于匹配七层访问流量的URL路径。URL路径支持精确匹配和前缀匹配两种。

- 动作：匹配转发规则后执行的动作，取值包括转发至和重定向至。转发至即将访问请求转发给指定的后端服务处理；重定向至即将访问请求重定向至指定的URL。

## 后端服务

- 服务规则：定义后端服务器可接收的协议类型与端口号。当后端服务关联虚拟服务器组时，如果虚拟服务器组中注册的实例（虚机或者容器）定义了端口，应用负载均衡使用实例定义的端口将报文转发给服务实例；如果虚拟服务器组中注册的实例（虚机或者容器）没有定义端口，应用负载均衡会采用后端服务定义的端口号将报文转发给服务实例。当后端服务关联高可用组时，高可用组内的服务实例没有定义端口信息，因此应用负载均衡会采用后端服务定义的端口号将报文转发给服务实例。

- 调度算法选择：支持加权轮询、加权最小连接、加权源IP三种调度算法。可根据自身业务需求选择合适的算法进行流量分配，例如后端主机性能差别不大的情况下可选择加权轮询算法，以均匀后端主机流量分配、提升对外服务能力；也可以选择加权源IP转发，将相同来源的客户端请求通过哈希表映射到后端同一台服务器。同时可根据后端服务器性能配置权重（加权的权重值通过向虚拟服务器组注册实例时设置），可设置0-100的整数，高配置的服务器可设置更高的权重，承载更多的访问流量，当后端服务关联高可用组时，高可用组内所有实例的权重相同。

- 会话保持设置：针对HTTPS/HTTP支持会话保持。应用负载均衡采用在应用负载均衡的HTTP响应报文头（后端服务器回复）中插入cookie的方式，实现相同来源的请求转发至后端同一台服务器进行处理。具体原理参见“基础架构”中“会话保持原理”部分内容。

- 源IP透传：针对HTTPS/HTTP/TCP/TLS/UDP协议可以设置源IP透传，实现将来访客户端IP透传给后端服务器。四、七层协议实现原理不同，七层协议采用在http头中插入X-Forwarded-For字段将源IP信息承载到服务端；四层协议采用扩展proxy protocol的方式来承载源IP信息到服务端。

- 健康检查：应用负载均衡会定时检测后端服务器运行状况，可自定义检测频率与健康/不健康判断条件；一旦检测到服务器运行异常，则不会再将流量分配给这些异常的实例，直至检测到实例运行正常后再恢复流量转发，保证服务的可用性。

- 服务关联：每个后端服务当前可以关联一个虚拟服务器组或高可用组。

## 虚拟服务器组

- 注册/取消注册后端服务器：用户可手动向虚拟服务器组中添加或者删除后端服务器。后端服务器包括云主机、容器和IP地址3种类型。

- 后端服务器的端口定义：向虚拟服务器组注册后端服务器时，如果定义了端口，应用负载均衡使用定义的端口将报文转发给后端服务器；如果注册后端服务器时没有定义端口，应用负载均衡会采用后端服务定义的端口号将报文转发给后端服务器。

- 后端服务器的权重定义：向虚拟服务器组注册后端服务器时，如果定义了权重，应用负载均衡则按照后端服务定义的调度算法+定义的权重进行报文的加权转发。例如，虚拟服务器组有2个后端服务器，权重分别为5和10，后端服务选择加权轮询，应用负载均衡就会按照1:2的比例把流量转发给两个后端服务器。

- 关联AS（Auto Scaling ）：应用负载均衡的虚拟服务器组可以通过关联AS，以实现服务实例的自动弹性伸缩。不过AS的弹性伸缩只考虑可用区（AZ）级的资源分配调度，不考虑机房内（例如跨机架）的高可用，如跨机架粒度的高可用保障，请使用高可用组。

## 高可用组

高可用组功能不属于应用负载均衡，但可以与应用负载均衡的后端服务关联，高可用组具备弹性伸缩能力，可根据业务负载情况自调节后端服务主机数量，以提供跨AZ、机房内跨机架的细粒度高可用服务能力。


## 相关参考

- [产品简介](../Introduction/Product-Overview.md)
- [产品规格](../Introduction/Specification.md)
- [价格总览](../Pricing/Price-Overview.md)
- [创建实例](../Getting-Started/Create-Instance.md)
- [虚拟服务器组管理](../Operation-Guide/TargetGroup-Management.md)
- [监听器管理](../Operation-Guide/Listener-Management.md)
- [管理后端服务与查看服务实例健康状态](../Operation-Guide/Backend-Management.md)
- [查看监控信息](../Operation-Guide/Monitoring.md)


